{% extends "base.html" %}
{% block title %}Appointment Notes{% endblock %}
{% block head %}
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<link href="/static/literallycanvas.css" rel="stylesheet">
<link href="/static/quill.snow.css" rel="stylesheet">
<script src="/static/react-with-addons.js"></script>
<script src="/static/react-dom.js"></script>
<script src="/static/literallycanvas.js"></script>
<script src="/static/quill.js"></script>
{% endblock %}

{% block main %}
  <div class="main">
    <h2>Adding note for appointment on {{bookings['name']}} with {{client}}</h2>
    <h3>Note entry</h3>
    <div class="edit-wrap">
      <div id="editor">
        <h3>Patient Details</h3>
        <p><br/></p>
        <h3>Symptom</h3>
        <p><br/></p>
        <h3>Diagnosis</h3>
        <p><br/></p>
        <h3>Treatment</h3>
        <p><br/></p>
      </div>
    </div>
    <h3>Add diagram</h3>
    <div id="my-drawing"></div>
    <form name="form1" method="POST">
      <input type="hidden" id="note" name="note"/>
      <input type="hidden" id="img" name="img"/>
    </form>
    <br><button onClick="upload_file();"> Submit </button>
  </div>

  <script>
    var bodyImg = document.createElement("IMG");
    bodyImg.src = "/static/pics/body.png";
    lc = LC.init(
      document.getElementById('my-drawing'),
      {imageURLPrefix: '/static/pics/literallycanvas',
       backgroundShapes: [
          LC.createShape(
           'Image', {x: 0, y: 0, image: bodyImg, scale: 0.5}
           )
       ]}
    );
    function upload_file(){
      var note=document.getElementById('editor').children[0];
      document.getElementById('note').value = note.innerHTML;
      var blob = lc.getImage().toDataURL();
      document.getElementById('img').value = blob;
      document.form1.submit();
    };
    let BlockEmbed = Quill.import('blots/block/embed');
    class DividerBlot extends BlockEmbed {
    }
    DividerBlot.blotName = 'divider';
    DividerBlot.tagName = 'hr';
    Quill.register(DividerBlot);

    var toolbarOptions = [
    //  [{ 'font': [] }],
      [{ 'header': [1, 2, false] }],
      ['bold', 'italic', 'underline', 'strike'],        // toggled buttons

      [{ 'list': 'ordered'}, { 'list': 'bullet' }],
      [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent

      [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme
      [{ 'align': [] }],
      ['blockquote', 'code-block'],
      //['divider'],

      ['clean']                                         // remove formatting button
    ];

    var quill = new Quill('#editor', {
      modules: {
         toolbar: toolbarOptions
      },
      theme: 'snow'
    });
  </script>
{% endblock %}
